<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Tren Kehilangan Tutupan Pohon Multi-Kecamatan</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin:0; padding:0; width:100%; height:100%;
      font-family:'Roboto Mono', monospace;
      background:#fff; color:#222;
      overflow:hidden;
    }
    .wrap { width:100%; height:100%; display:flex; flex-direction:column; }
    .header {
      padding:8px;
      display:flex;
      justify-content:space-between; /* H1 kiri, dropdown kanan */
      align-items:center;
    }
    .header h1 {
      font-size:14px;
      margin:0;
      font-weight:normal;
    }
    select {
       padding:2px 6px; border-radius:4px; border:1px solid #ccc;
      font-family:'Roboto Mono', monospace; font-size:12px;
    }
    .chart-container { flex:1; position:relative; width:100%; height:80% !important; }
    canvas { width:100% !important; height:100% !important; font-family:'Roboto Mono', monospace !important; }
    @media (max-width: 600px) {
      .chart-container{max-width:300px}
    }
    @media (max-width: 600px) {
  .header {
    flex-direction: column; /* tumpuk ke bawah */
    align-items: flex-start; /* rata kiri */
  }

  .header h1 {
    margin-bottom: 6px; /* beri jarak ke dropdown */
    font-size: 0.9em; /* bisa sedikit diperbesar di HP */
  }

  .header select {
    width: auto;              /* ukuran sama seperti default */
    max-width: none;          /* biar tidak ada batasan */
  }
}

  </style>
</head>
<body>
<div class="wrap">
  <div class="header">
    <h1 style="font-size:0.8em; line-height:1.4; text-align: left;">Tren Kehilangan Tutupan Pohon: APL vs Kawasan Hutan</h1>
    <select id="kecamatanSelect">
      <option value="Semua">Semua Kecamatan</option>
      <option value="Bandar Negeri Semuong">Bandar Negeri Semuong</option>
      <option value="Semaka">Semaka</option>
      <option value="Wonosobo">Wonosobo</option>
    </select>
  </div>
  <div class="chart-container">
    <canvas id="lossChart"></canvas>
  </div>
</div>

<script>
// Data tahun
const years = Array.from({length: 2024-2001+1}, (_,i)=>2001+i);

// Data kehilangan tutupan pohon
const dataLoss = {
  "Bandar Negeri Semuong": {
    apl: [4,5,1,10,10,6,2,10,10,10,12,13,7,12,22,78,43,65,69,33,11,15,29,31],
    hutan: [9,9,6,34,13,38,11,26,27,18,31,19,8,26,30,10,20,8,59,6,8,8,141,32]
  },
  "Semaka": {
    apl: [11,4,1,6,5,10,6,15,33,18,7,7,2,3,21,62,11,8,10,8,9,15,38,14],
    hutan: [29,77,16,61,14,121,28,71,80,39,79,26,6,30,92,21,25,15,43,10,11,13,34,16]
  },
  "Wonosobo": {
    apl: [10,12,2,5,5,13,4,8,10,6,12,6,2,2,14,158,161,194,69,26,5,3,12,16],
    hutan: [4,5,1,11,5,16,2,9,7,11,12,4,1,3,2,1,4,1,1,1,0,1,1,14]
  }
};

// Warna kategori
const aplColor = "lightgrey";
const hutanColor = "green";

let ctx = document.getElementById('lossChart').getContext('2d');
let chart;

function buildDatasets(kecamatan){
  let datasets = [];
  if(kecamatan==="Semua"){
    for(const kec in dataLoss){
      datasets.push({
        label: kec+" - APL",
        data: dataLoss[kec].apl,
        borderColor: aplColor,
        backgroundColor: aplColor,
        tension:0.2,
        pointRadius:3,
        pointHoverRadius:4
      });
      datasets.push({
        label: kec+" - Kawasan Hutan",
        data: dataLoss[kec].hutan,
        borderColor: hutanColor,
        backgroundColor: hutanColor,
        tension:0.2,
        pointRadius:3,
        pointHoverRadius:4
      });
    }
  } else {
    datasets.push({
      label: kecamatan+" - APL",
      data: dataLoss[kecamatan].apl,
      borderColor: aplColor,
      backgroundColor: aplColor,
      tension:0.2,
      pointRadius:3,
      pointHoverRadius:4
    });
    datasets.push({
      label: kecamatan+" - Kawasan Hutan",
      data: dataLoss[kecamatan].hutan,
      borderColor: hutanColor,
      backgroundColor: hutanColor,
      tension:0.2,
      pointRadius:3,
      pointHoverRadius:4
    });
  }
  return datasets;
}

function buildChart(kecamatan){
  if(chart) chart.destroy();
  chart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: years,
      datasets: buildDatasets(kecamatan)
    },
    options: {
      responsive:true,
      maintainAspectRatio:false,
      plugins:{
        legend:{ 
          position:"bottom", 
          labels:{ 
            font:{family:"Roboto Mono"},
           color:"#000",
            usePointStyle:true,
            generateLabels: function(chart){
              return [
                {text:"APL", strokeStyle:aplColor, fillStyle:aplColor, lineWidth:2, pointStyle:"line"},
                {text:"Kawasan Hutan", strokeStyle:hutanColor, fillStyle:hutanColor, lineWidth:2, pointStyle:"line"}
              ];
            }
          } 
        },
        tooltip:{
          bodyFont:{family:"Roboto Mono"},
          titleFont:{family:"Roboto Mono"},
          callbacks:{ label:(context)=> context.dataset.label+": "+context.formattedValue+" ha" }
        }
      },
      scales:{
        y:{ 
          title:{display:true, text:"Luas Kehilangan (ha)", font:{family:"Roboto Mono"}},
          ticks:{font:{family:"Roboto Mono"}}
        },
        x:{ 
          title:{display:true, text:"Tahun", font:{family:"Roboto Mono"}},
          ticks:{maxRotation:90,minRotation:90,font:{family:"Roboto Mono"}}
        }
      }
    }
  });
}

document.getElementById('kecamatanSelect').addEventListener('change', function(){
  buildChart(this.value);
});

// tampilkan semua kecamatan pertama kali
buildChart("Semua");
</script>
</body>
</html>
